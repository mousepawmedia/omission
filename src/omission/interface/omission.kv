#:kivy 1.10.0
#:import hex kivy.utils.get_color_from_hex
#:import img_loader omission.data.img_loader

#Top level element is a FloatLayout, for popup items.
<OmissionWindow>:
    size_hint_x_minimum:

<Menu>:
    # Game menu.
    orientation: 'vertical'
    size_hint: (0.9, 0.9)
    pos_hint: {'center': (0.5, 0.5)}
    spacing: '20px'
    BoxLayout:
        # Logo box
        size_hint_y: 0.4
        Image:
            size_hint_x: 0.5
            source: img_loader.load_image("omission_glow.png")
    BoxLayout:
        # Mode box.
        orientation: 'horizontal'
        size_hint_y: 0.2
        DecorativeToggleButton:
            id: btn_timed
            group: 'game_mode'
            text: 'Timed'
            on_press: root.press_toggle('Timed', self)
        DecorativeToggleButton:
            id: btn_survival
            group: 'game_mode'
            text: 'Survival'
            on_press: root.press_toggle('Survival', self)
        DecorativeToggleButton:
            id: btn_infinite
            group: 'game_mode'
            text: 'Infinite'
            on_press: root.press_toggle('Infinite', self)
    BoxLayout:
        # Action box.
        orientation: 'horizontal'
        spacing: '20px'
        id: box_controls

<InfoBox>:
    orientation: 'vertical'
    DecorativeLabel:
        size_hint_y: 0.3
        font_size: '30sp'
        text: "Select a mode above to play."
    DecorativeLabel:
        text: "Created by MousePaw Games\nwww.mousepawgames.com"
        halign: 'center'
        color: hex("#FFFFFF")
        font_size: '20sp'
    BoxLayout:
        orientation: 'horizontal'
        size_hint_y: 0.15
        spacing: '20px'
        DecorativeSpinner:
            id: spn_vol
            text: 'Vol: High'
            font_size: '15sp'
            values: ('Vol: Off', 'Vol: Low', 'Vol: Med', 'Vol: High')
            on_text: root.volume()
        DecorativeSpinner:
            id: spn_dys
            text: 'Normal'
            font_size: '15sp'
            values: ('Normal', 'Dyslexic')
            on_text: root.font_mode()
        DecorativeButton:
            text: "Rules"
            font_size: '15sp'
            on_press: root.press_rules()
        DecorativeButton:
            text: "Credits"
            font_size: '15sp'
            on_press: root.press_credits()
        DecorativeButton:
            text: "Quit"
            font_size: '15sp'
            on_press: root.press_quit()

<PlayBox>:
    # Button box.
    orientation: 'vertical'
    size_hint_x: 2
    DecorativeButton:
        id: btn_play
        on_press: root.press_play()
        size_hint_y: 0.3
        font_size: '30sp'
        text: 'Play'
    DecorativeLabel:
        text: "HIGH SCORES"
        font_size: '25sp'
        size_hint_y: 0.2
    DecorativeLabel:
        id: lbl_scores
        font_size: '20sp'
        color: hex("#FFFFFF")
        size_hint_y: 1.0
        text: ""
        text_size: self.size
        valign: 'top'
        halign: 'center'

<TimedSettings>:
    orientation: 'vertical'
    spacing: '5px'
    DecorativeLabel:
        text: 'Timer Length'
        font_size: '20sp'
        color: hex("#FFFFFF")
    DecorativeSpinner:
        id: spn_time
        text: '30'
        values: ('15', '30', '60', '90', '120')
        on_text: root.changed()
    DecorativeLabel:
        text: 'Bonus'
        font_size: '20sp'
        color: hex("#FFFFFF")
    DecorativeSpinner:
        id: spn_bonus
        text: '3'
        values: ('1', '2', '3', '4', '5')
        on_text: root.changed()
    DecorativeLabel:
        text: 'Penalty'
        font_size: '20sp'
        color: hex("#FFFFFF")
    DecorativeSpinner:
        id: spn_penalty
        text: '1'
        values: ('1', '2', '3', '4', '5')
        on_text: root.changed()
    DecorativeLabel:
        text: 'Tries'
        color: hex("#FFFFFF")
        font_size: '20sp'
    DecorativeSpinner:
        id: spn_tries
        text: '3'
        values: ('1', '2', '3', '4', '5')
        on_text: root.changed()

<SurvivalSettings>:
    orientation: 'vertical'
    spacing: '5px'
    DecorativeLabel:
        text: 'Lives'
        font_size: '20sp'
        color: hex("#FFFFFF")
    DecorativeSpinner:
        id: spn_lives
        text: '3'
        values: ('1', '2', '3', '4', '5')
        on_text: root.changed()
    DecorativeLabel:
        text: 'Tries'
        color: hex("#FFFFFF")
        font_size: '20sp'
    DecorativeSpinner:
        id: spn_tries
        text: '3'
        values: ('1', '2', '3', '4', '5')
        on_text: root.changed()

<InfiniteSettings>:
    orientation: 'vertical'
    spacing: '5px'
    DecorativeLabel:
        text: 'Tries'
        color: hex("#FFFFFF")
        font_size: '20sp'
    DecorativeSpinner:
        id: spn_tries
        text: '3'
        values: ('1', '2', '3', '4', '5')
        on_text: root.changed()

<TrySettings>:
    orientation: 'vertical'
    spacing: '5px'
    DecorativeLabel:
        text: 'Hint On...'
        color: hex("#FFFFFF")
        font_size: '20sp'
    DecorativeSpinner:
        id: spn_hint
        text: '2'
        values: ('1', '2', '3', '4', '5')
        on_text: root.changed()
    DecorativeLabel:
        text: 'Clue On...'
        color: hex("#FFFFFF")
        font_size: '20sp'
    DecorativeSpinner:
        id: spn_clue
        text: '3'
        values: ('1', '2', '3', '4', '5')
        on_text: root.changed()
    DecorativeLabel:
        text: 'Chain Time'
        color: hex("#FFFFFF")
        font_size: '20sp'
    DecorativeSpinner:
        id: spn_chain
        text: '2'
        values: ('1', '2', '3', '4', '5')
        on_text: root.changed()
    DecorativeLabel:
        text: 'Show Passage'
        color: hex("#FFFFFF")
        font_size: '20sp'
    DecorativeSpinner:
        id: spn_passage
        text: 'True'
        values: ('True', 'False')
        on_text: root.changed()

<Highscore>:
    # Highscore prompt.
    orientation: 'vertical'
    size_hint: (0.9, 0.9)
    pos_hint: {'center': (0.5, 0.5)}
    spacing: '20px'

    DecorativeLabel:
        text: 'New Highscore!'
        font_size: '35sp'
    DecorativeLabel:
        id: lbl_score
        text: '000000'
        font_size: '30sp'
    DecorativeLabel:
        text: 'Enter your name and press ENTER to continue.'
        color: hex("#FFFFFF")
        font_size: '20sp'
    NameTextInput:

<NameTextInput>:
    id: txt_name
    foreground_color: hex('#00FF00')
    background_color: hex('#262626')
    font_size: '25sp'
    #font_name: 'resources/font/orbitron/orbitron-medium.otf'
    size_hint_y: None
    # Single line
    multiline: False
    # When we press enter, submit the form.
    on_text_validate: root.submit()
    # Grab focus.
    focus: True

<Credits>:
    size_hint: (0.9, 0.9)
    pos_hint: {'center': (0.5, 0.5)}
    canvas.before:
        Color:
            rgba: hex('#003300')
        Rectangle:
            pos: self.pos
            size: self.size
    PassageLabel:
        id: lbl_credits
        padding: ('10sp', '10sp')
        text: "CREDITS"
        halign: 'center'
        valign: 'middle'
        color: hex("#FFFFFF")
        font_size: '20sp'

<Rules>:
    size_hint: (0.95, 0.95)
    pos_hint: {'center': (0.5, 0.5)}
    canvas.before:
        Color:
            rgba: hex('#003300')
        Rectangle:
            pos: self.pos
            size: self.size
    ScrollView:
        id: scroll
        bar_width: 5
        PassageLabel:
            id: lbl_rules
            padding: ('10sp', '10sp')
            text: "RULES"
            font_size: '20sp'
            #text_size: self.size
            text_size: self.width, None
            height: self.texture_size[1]
            size_hint_y: None
            halign: 'left'
            valign: 'top'
            color: hex("#FFFFFF")

<Gameplay>:
    # Main box, holding the other three.
    orientation: 'vertical'
    size_hint: (0.9, 0.9)
    pos_hint: {'center': (0.5, 0.5)}
    spacing: '20px'
    BoxLayout:
        # Top bar.
        orientation: 'horizontal'
        size_hint_y: 0.08
        spacing: '10px'
        BoxLayout:
            orientation: 'vertical'
            spacing: '10px'
            DecorativeLabel:
                text: "Tries Left"
                font_size: '15sp'
            DecorativeLabel:
                id: lbl_tries
                text: "3"
                font_size: '30sp'
        BoxLayout:
            orientation: 'vertical'
            spacing: '10px'
            DecorativeLabel:
                text: "Score"
                font_size: '15sp'
            DecorativeLabel:
                id: lbl_score
                text: "00000000"
                font_size: '30sp'
        BoxLayout:
            orientation: 'vertical'
            spacing: '10px'
            DecorativeLabel:
                text: "Removals"
                font_size: '15sp'
            DecorativeLabel:
                id: lbl_removals
                text: "0"
                font_size: '30sp'
    BoxLayout:
        # Center box.
        orientation: 'horizontal'
        spacing: '10px'
        PassageLabel:
            id: lbl_puzzle
            text: "The passage you need to solve."
            font_size: '20sp'
            text_size: self.size
            halign: 'center'
            valign: 'middle'
            canvas.before:
                Color:
                    rgba: hex('#003300')
                Rectangle:
                    pos: self.pos
                    size: self.size
        BoxLayout:
            size_hint_x: None
            orientation: 'vertical'
            DecorativeLabel:
                # Display chain bonus.
                id: lbl_chain
                size_hint_y: 0.1
                text: "CHAIN"
                font_size: '30sp'
            DecorativeLabel:
                # Display guesses
                id: lbl_guess
                size_hint_y: 0.9
                text: "g\nu\ne\ns\ns"
                font_size: '30sp'
    BoxLayout:
        # Bottom bar.
        orientation: 'horizontal'
        size_hint_y: 0.08
        Image:
            id: img_mode
            size_hint_x: None
            color: hex("#00FF00")
            source: img_loader.load_image("clock.png")
        ProgressBar:
            id: bar_remaining
            value: 50
            #size_hint_x: None
        DecorativeLabel:
            id: lbl_remaining
            size_hint_x: 0.3
            #size: self.texture_size
            text: "00:00"
            font_size: '30sp'
        DecorativeLabel:
            id: lbl_lives
            size_hint_x: 0.1
            text: "[3]"
            font_size: '30sp'

<PassageLabel>:
    color: hex('#FFFFFF')
    #font_name: 'resources/font/source-sans-pro/SourceSansPro-Regular.otf'

<DecorativeLabel>:
    color: hex("#00FF00")
    outline_color: hex('#007700')
    outline_width: '2px'
    #font_name: 'resources/font/orbitron/orbitron-medium.otf'

<DecorativeSpinner>:
    color: hex("#FFFFFF")
    outline_color: hex('#007700')
    outline_width: '2px'
    font_size: '20sp'
    #font_name: 'resources/font/orbitron/orbitron-medium.otf'

<DecorativeButton>:
    color: hex("#FFFFFF")
    outline_color: hex('#007700')
    outline_width: '2px'
    font_size: '20sp'
    #font_name: 'resources/font/orbitron/orbitron-medium.otf'

<DecorativeToggleButton>:
    color: hex("#FFFFFF")
    outline_color: hex('#007700')
    outline_width: '2px'
    font_size: '20sp'
    #font_name: 'resources/font/orbitron/orbitron-medium.otf'

<PopupLabel>:
    #color: hex("#FFFFFF")
    outline_color: hex('#000000')
    outline_width: '5px'
    font_size: '40sp'
    #font_name: 'resources/font/orbitron/orbitron-medium.otf'
    text: "Popup"

<PopupMessage>:
    size_hint: (None, None)
    size: (400, 400)
    title_align: 'center'
    title_size: '20sp'
    title_color: hex("#00FF00")
    BoxLayout:
        orientation: 'vertical'
        PassageLabel:
            id: lbl_msg
            size_hint_y: 0.9
            color: hex("#FFFFFF")
            font_size: '20sp'
            text_size: self.size
            halign: 'center'
            valign: 'middle'
            text: ""
        DecorativeButton:
            text: "OK"
            size_hint_y: 0.1
            on_press: root.dismiss()
